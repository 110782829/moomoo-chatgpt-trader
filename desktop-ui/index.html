<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Moomoo Trader</title>
</head>
<body>
  <h1>Bot Dashboard</h1>
  <section id="mode">
    <h2>Autonomy Mode</h2>
    <select id="mode-select"></select>
  </section>
  <section id="risk">
    <h2>Risk Settings</h2>
    <pre id="risk-json"></pre>
  </section>
  <section id="strategies">
    <h2>Strategies</h2>
    <ul id="strategy-list"></ul>
  </section>
  <section id="log">
    <h2>Activity Log</h2>
    <pre id="log-json"></pre>
  </section>
  <script>
    const API_BASE = "http://127.0.0.1:8000";
    async function load() {
      const modeRes = await fetch(API_BASE + "/bot/mode");
      const modeData = await modeRes.json();
      const select = document.getElementById("mode-select");
      ["assist","semi","auto"].forEach(m => {
        const opt = document.createElement("option");
        opt.value = m;
        opt.textContent = m;
        if (modeData.mode === m) opt.selected = true;
        select.appendChild(opt);
      });
      select.onchange = async () => {
        await fetch(API_BASE + "/bot/mode", {
          method: "PUT",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({mode: select.value})
        });
      };

      const risk = await (await fetch(API_BASE + "/risk/config")).json();
      document.getElementById("risk-json").textContent = JSON.stringify(risk, null, 2);

      const strats = await (await fetch(API_BASE + "/automation/strategies")).json();
      const list = document.getElementById("strategy-list");
      strats.forEach(s => {
        const li = document.createElement("li");
        li.textContent = s.name || ("strategy " + s.id);
        list.appendChild(li);
      });

      const log = await (await fetch(API_BASE + "/logs/actions")).json();
      document.getElementById("log-json").textContent = JSON.stringify(log, null, 2);
    }
    load();
  </script>
</body>
</html>
